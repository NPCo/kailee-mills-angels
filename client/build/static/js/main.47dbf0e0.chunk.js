(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(e,t,n){e.exports=n(320)},128:function(e,t,n){},320:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(48),o=n.n(i),c=(n(128),n(19)),l=n(20),s=n(22),u=n(21),d=n(23),h=n(24),m=n(2),g=n(117),p=n.n(g),f=n(118),b=n.n(f),v=n(119),E=n.n(v),y=n(39),j=n.n(y),x=n(122),O=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={hovered:!1,selected:!1,zIndex:0},n.enabled=!!n.props.thumbnail,n.expand=n.expand.bind(Object(m.a)(Object(m.a)(n))),n.contract=n.contract.bind(Object(m.a)(Object(m.a)(n))),n.select=n.select.bind(Object(m.a)(Object(m.a)(n))),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.props.trigger()}},{key:"expand",value:function(){this.enabled&&!this.state.selected&&this.setState({hovered:!0,zIndex:1})}},{key:"contract",value:function(){this.enabled&&this.setState({hovered:!1,zIndex:0})}},{key:"select",value:function(){this.enabled&&(this.setState({selected:!0}),this.contract(),this.props.onSelected())}},{key:"render",value:function(){var e={exiting:{marginTop:this.props.expandMargin.top,marginLeft:this.props.expandMargin.left,marginBottom:this.props.expandMargin.bottom,marginRight:this.props.expandMargin.right,background:this.props.color,zIndex:1}};return r.a.createElement("div",{className:"transition-smooth",onMouseEnter:this.expand,onMouseLeave:this.contract,onClick:this.select,style:Object(x.a)({cursor:this.enabled?"pointer":"default",background:"url(".concat(this.props.thumbnail,") no-repeat 50% 50%"),backgroundColor:this.props.color,transform:"scale(".concat(this.state.hovered?1.1:1,")"),zIndex:this.state.zIndex,gridArea:[+this.props.y,+this.props.x,+this.props.y+(+this.props.h||1),+this.props.x+(+this.props.w||1)].join(" / ")},e[this.props.transitionState])})}}]),t}(a.Component),w=n(120),k=function(e){var t=e.angel,n=e.height,a=e.exit;return r.a.createElement("div",{style:{backgroundColor:t.color,height:n},className:"angel-expanded"},r.a.createElement("div",{className:"angel-photo fade-in"},r.a.createElement("img",{alt:t.name,src:t.photo})),r.a.createElement("div",{className:"angel-title fade-in"},r.a.createElement("span",{className:"angel-name"},t.name),r.a.createElement("span",{className:"angel-dates"},t.dates),r.a.createElement("div",{className:"angel-exit clickable",onClick:a},r.a.createElement("div",{className:"close icon"}))),r.a.createElement("div",{className:"angel-bio fade-in"},r.a.createElement(w,{source:t.bio})))},C={color:"white",photo:"#",name:"...",dates:"",bio:[]},A=function(e){return e.hasOwnProperty("_id")?e:Object.assign(e,{_id:j()()})},T=E()()(function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={selectedId:null,triggered:!1,angels:[]};var a=n.props.angels;return"function"===typeof a?a().then(function(e){return e.map(A)}).then(function(e){return n.setState({angels:e})}).catch(function(e){return console.error("Error getting angels -",e)}):n.state=Object.assign(n.state,{angels:a.map(A)}),n.selectId=n.selectId.bind(Object(m.a)(Object(m.a)(n))),n.trigger=n.trigger.bind(Object(m.a)(Object(m.a)(n))),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"selectId",value:function(e){this.setState({selectedId:e,triggered:!1})}},{key:"trigger",value:function(){this.setState({triggered:!0})}},{key:"render",value:function(){var e=this,t=this.state,n=t.angels,a=t.selectedId,i=this.props,o=i.width,c=i.height,l=+(this.props.columns||Math.max.apply(Math,Object(h.a)(n.map(function(e){return+e.w+ +e.x-1})))||4),s=+(this.props.rows||Math.max.apply(Math,Object(h.a)(n.map(function(e){return+e.h+ +e.y-1})))||3),u=(this.props.size.width-l*o)/(l-1);if(this.state.triggered){var d=Object.assign(C,n.find(function(e){return e._id===a}));return r.a.createElement(k,{angel:d,height:"".concat(s*(c+10)-10,"px"),exit:function(){return e.selectId(null)}})}return r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(".concat(l||4,", ").concat(o||100,"px)"),gridTemplateRows:"repeat(".concat(s||3,", ").concat(c||100,"px)"),columnGap:"calc((100% - ".concat(l*o,"px) / ").concat(l-1,")"),height:"".concat(s*(c+10)-10,"px"),rowGap:"".concat(10,"px")}},r.a.createElement(p.a,{component:null},n.filter(function(e){return e._id!==a}).map(function(t){return r.a.createElement(b.a,{key:"angel-element-".concat(t._id),timeout:{exit:500},unmountOnExit:!0},function(n){return r.a.createElement(O,Object.assign({transitionState:n,onSelected:function(){return e.selectId(t._id)},expandMargin:{top:"".concat((c+10)*(1-t.y),"px"),left:"".concat((o+u)*(1-t.x),"px"),bottom:"".concat((c+10)*(t.y+t.h-1-s),"px"),right:"".concat((o+u)*(t.x+t.w-1-l),"px")},trigger:function(){return e.trigger()}},t))})})))}}]),t}(a.Component)),N=n(49),S=function(e){return r.a.createElement("div",{className:"angel-list-item clickable",onClick:e.onClick,style:{backgroundColor:e.color}},r.a.createElement("h3",{style:{margin:0,fontStyle:e.name?"normal":"italic"}},e.name||"Blank"))},I=n(9),M=function(e){var t=e._id,n=e.onValueChange,a=e.removeAngel,i=Object(N.a)(e,["_id","onValueChange","removeAngel"]);return r.a.createElement("div",{style:{backgroundColor:i.color,gridArea:"edit"}},r.a.createElement(I.Form,{key:"form-".concat(t),initialValues:i,onValueChange:n},r.a.createElement("div",{className:"edit-angel-form"},r.a.createElement("div",{className:"angel-form-info"},r.a.createElement("label",{htmlFor:"angel-name"},"Name:"),r.a.createElement(I.Text,{field:"name",id:"angel-name"}),r.a.createElement("label",{htmlFor:"angel-dates"},"Dates:"),r.a.createElement(I.Text,{field:"dates",id:"angel-dates",placeholder:"e.g. 2000 - 2000"}),r.a.createElement("label",{htmlFor:"angel-color"},"Color:"),r.a.createElement(I.Text,{field:"color",id:"angel-color",placeholder:"e.g. #d7f5e1"}),r.a.createElement("label",{htmlFor:"angel-photo"},"Biography Photo:"),r.a.createElement(I.Text,{field:"photo",id:"angel-photo",placeholder:"e.g. https://static.wixstatic.com/media/img.jpg"}),r.a.createElement("label",{htmlFor:"angel-thumbnail"},"Thumbnail Photo:"),r.a.createElement(I.Text,{field:"thumbnail",id:"angel-thumbnail",placeholder:"e.g. https://static.wixstatic.com/media/img.jpg"})),r.a.createElement("div",{className:"angel-form-bio"},r.a.createElement("label",{htmlFor:"angel-bio"},"Biography:"),r.a.createElement(I.TextArea,{field:"bio",id:"angel-bio"})),r.a.createElement("div",{className:"angel-form-info"},r.a.createElement("label",{htmlFor:"angel-col"},"Column:"),r.a.createElement(I.Text,{field:"x",id:"angel-col"}),r.a.createElement("label",{htmlFor:"angel-row"},"Row:"),r.a.createElement(I.Text,{field:"y",id:"angel-row"}),r.a.createElement("label",{htmlFor:"angel-width"},"Width:"),r.a.createElement(I.Text,{field:"w",id:"angel-width"}),r.a.createElement("label",{htmlFor:"angel-height"},"Height:"),r.a.createElement(I.Text,{field:"h",id:"angel-height"}),r.a.createElement("button",{onClick:a,style:{gridColumn:"1 / 3"}},"Delete")))))},_=["#d7f5e1","#deeeee","#f17079"],F=function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={angels:[],focusId:null,isBusy:!0};var a=n.props.angels;return"function"===typeof a?a().then(function(e){return n.setState({angels:e,isBusy:!1})}).catch(function(e){return console.error("Error getting angels -",e)}):n.state=Object.assign(n.state,{angels:a,isBusy:!1}),n.focus=n.focus.bind(Object(m.a)(Object(m.a)(n))),n.editAngel=n.editAngel.bind(Object(m.a)(Object(m.a)(n))),n.newAngel=n.newAngel.bind(Object(m.a)(Object(m.a)(n))),n.removeAngel=n.removeAngel.bind(Object(m.a)(Object(m.a)(n))),n.authenticateThen=n.authenticateThen.bind(Object(m.a)(Object(m.a)(n))),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"focus",value:function(e){this.setState({focusId:e})}},{key:"editAngel",value:function(e){var t=this.state,n=t.angels,a=t.focusId,r=n.findIndex(function(e){return e._id===a}),i=n[r],o=Object.assign(i,e);this.setState({angels:[].concat(Object(h.a)(n.slice(0,r)),[o],Object(h.a)(n.slice(r+1)))})}},{key:"newAngel",value:function(){var e=this.state.angels,t=j()(),n=_[e.length%_.length],a=Math.max.apply(Math,Object(h.a)(e.map(function(e){return+e.w+ +e.x-1})).concat([1])),r=Math.max.apply(Math,Object(h.a)(e.map(function(e){return+e.h+ +e.y-1})).concat([1])),i=Array(a*r||1).fill(!1);e.forEach(function(e){for(var t=e.x-1;t<e.x+ +e.w-1;t++)for(var n=e.y-1;n<e.y+ +e.h-1;n++)i[t*r+n]=!0});var o=i.findIndex(function(e){return!e}),c=-1!==o?Math.floor(o/r)+1:a>r?1:a+1,l=-1!==o?o%r+1:a>r?r+1:1;this.setState({angels:e.concat({_id:t,color:n,x:c,y:l,w:1,h:1}),focusId:t})}},{key:"removeAngel",value:function(e){this.setState({angels:this.state.angels.filter(function(t){return t._id!==e}),focusId:null})}},{key:"authenticateThen",value:function(e){return function(){var t=this,n=prompt("Database Username:",this.state.username||""),a=prompt("Database Password:",this.state.password||"");this.setState({username:n,password:a,isBusy:!0});var r=JSON.stringify({credentials:{username:n,password:a},angels:this.state.angels.map(function(e){e._id;return Object(N.a)(e,["_id"])})});console.log(r),e(r).then(function(e){return e.json()}).then(function(e){return console.log("successs",e)}).then(function(){return t.setState({isBusy:!1})}).catch(function(e){return console.log("error!",e)})}.bind(this)}},{key:"render",value:function(){var e=this,t=this.state,n=t.angels,a=t.focusId,i=t.isBusy,o=this.authenticateThen(this.props.saveDraft),c=this.authenticateThen(this.props.publish);return r.a.createElement("div",{className:"workspace-layout"},r.a.createElement("div",{className:"edit-live-demo"},r.a.createElement(T,{width:250,height:150,angels:n,key:j()()})),r.a.createElement("div",{className:"angel-list"},r.a.createElement("div",{className:"angel-list-item"},r.a.createElement("button",{onClick:function(){return e.newAngel()}},"New Angel"),r.a.createElement("button",{onClick:o,disabled:i},"Save Changes"),r.a.createElement("button",{onClick:c,disabled:i},"Publish")),n.map(function(t){return r.a.createElement(S,Object.assign({key:t._id},t,{onClick:function(){return e.focus(t._id)}}))})),a?r.a.createElement(M,Object.assign({onValueChange:this.editAngel,removeAngel:function(){return e.removeAngel(a)}},n.find(function(e){return e._id===a}))):r.a.createElement(r.a.Fragment,null))}}]),t}(a.Component),B=n(322),D=n(323),P=function(){return fetch("/api/angel").then(function(e){return e.json()}).then(function(e){return e.data})},W=function(){return r.a.createElement("div",{className:"three-by-three"},r.a.createElement("div",{className:"middle-center"},r.a.createElement(T,{width:250,height:150,angels:P})))},z=function(){return fetch("".concat("/api/angel","?isDraft=true")).then(function(e){return e.json()}).then(function(e){return e.data})},L={Accept:"application/json","Content-Type":"application/json"},R=function(e){return fetch("/api/angel",{method:"DELETE",headers:L,body:e}).then(function(){return fetch("/api/angel",{method:"POST",headers:L,body:e})}).then(function(){return U()})},U=function(e){return fetch("".concat("/api/angel","?isDraft=true"),{method:"DELETE",headers:L,body:e}).then(function(){return fetch("".concat("/api/angel","?isDraft=true"),{method:"POST",headers:L,body:e})})},V=function(){return r.a.createElement(F,{angels:z,publish:R,saveDraft:U})},J=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(B.a,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{path:"/",exact:!0,component:W}),r.a.createElement(D.a,{path:"/edit",component:V})))}}]),t}(a.Component),G=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function H(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(J,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");G?(function(e,t){fetch(e).then(function(n){404===n.status||-1===n.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):H(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):H(t,e)})}}()}},[[123,2,1]]]);
//# sourceMappingURL=main.47dbf0e0.chunk.js.map